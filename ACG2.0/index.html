<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACG v6.7 - OpenAI Native Content Creator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap');
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #050505;
            color: #f4f4f5;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 0% 0%, rgba(59, 130, 246, 0.15), transparent 40%),
                radial-gradient(circle at 100% 100%, rgba(147, 51, 234, 0.15), transparent 40%);
        }
        
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        .glass {
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(32px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(59, 130, 246, 0.5);
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #9333ea);
            color: #ffffff;
            font-weight: 800;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
        }
        
        .btn-primary:hover {
            transform: scale(1.02);
            filter: brightness(1.1);
            box-shadow: 0 8px 30px rgba(59, 130, 246, 0.6);
        }

        .ai-guide-float {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .instant-fade { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 10px; }

        .video-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }
        .video-btn:hover {
            background: #f43f5e;
            border-color: #f43f5e;
            color: white;
            box-shadow: 0 0 15px rgba(244, 63, 94, 0.4);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;

        const Icon = ({ name, size = 20, className = "" }) => {
            useEffect(() => { 
                if (window.lucide) window.lucide.createIcons(); 
            }, [name]);
            return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
        };

        const STEPS = [
            { id: 1, label: 'Ide', icon: 'zap', guide: "Selamat datang! Masukkan topik konten Anda, dan mari kita mulai proses kreatif dengan OpenAI." },
            { id: 2, label: 'Judul', icon: 'type', guide: "GPT telah memberikan saran judul. Pilih yang paling berpotensi viral!" },
            { id: 3, label: 'Hook', icon: 'anchor', guide: "Pilih kalimat pembuka (hook) yang paling memikat untuk audiens Anda." },
            { id: 4, label: 'Skrip', icon: 'file-text', guide: "Naskah video dan caption media sosial Anda sudah siap ditinjau." },
            { id: 5, label: 'Prompt', icon: 'image', guide: "Gunakan prompt visual ini pada AI Video Generator pilihan Anda." },
            { id: 6, label: 'Final', icon: 'sparkles', guide: "Luar biasa! Konten Anda siap untuk dipublikasikan sekarang." }
        ];

        const App = () => {
            const apiKey = ""; // Kunci API OpenAI akan disuntikkan secara otomatis di sini
            const [currentStep, setCurrentStep] = useState(1);
            const [loading, setLoading] = useState(false);
            const [loadingMsg, setLoadingMsg] = useState("");
            const [error, setError] = useState(null);
            const [isSpeaking, setIsSpeaking] = useState(false);
            const [guideEnabled, setGuideEnabled] = useState(true);
            
            const [data, setData] = useState({
                topic: "",
                titles: [],
                selectedTitle: "",
                hooks: [],
                selectedHook: "",
                script: "",
                imagePrompts: [],
                caption: ""
            });

            const lastStepRef = useRef(0);

            const copyToClipboard = (text) => {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
            };

            const speakGuide = useCallback((text) => {
                if (!guideEnabled || !('speechSynthesis' in window)) return;
                try {
                    window.speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(String(text));
                    utterance.lang = 'id-ID';
                    utterance.onstart = () => setIsSpeaking(true);
                    utterance.onend = () => setIsSpeaking(false);
                    utterance.onerror = () => setIsSpeaking(false);
                    window.speechSynthesis.speak(utterance);
                } catch (err) {
                    setIsSpeaking(false);
                }
            }, [guideEnabled]);

            useEffect(() => {
                if (currentStep !== lastStepRef.current) {
                    const step = STEPS.find(s => s.id === currentStep);
                    if (step) {
                        const timer = setTimeout(() => speakGuide(step.guide), 600);
                        lastStepRef.current = currentStep;
                        return () => clearTimeout(timer);
                    }
                }
            }, [currentStep, speakGuide]);

            const callOpenAI = async (prompt, systemPrompt) => {
                const url = "https://api.openai.com/v1/chat/completions";
                
                const payload = {
                    model: "gpt-4o",
                    messages: [
                        { role: "system", content: systemPrompt },
                        { role: "user", content: prompt }
                    ],
                    response_format: { type: "json_object" }
                };

                let delay = 1000;
                for (let i = 0; i < 5; i++) {
                    try {
                        const response = await fetch(url, {
                            method: 'POST',
                            headers: { 
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${apiKey}`
                            },
                            body: JSON.stringify(payload)
                        });
                        
                        if (!response.ok) {
                            const errorData = await response.json();
                            throw new Error(errorData.error?.message || "Gagal menghubungi OpenAI");
                        }
                        
                        const result = await response.json();
                        const content = result.choices[0].message.content;
                        return JSON.parse(content);
                    } catch (e) {
                        if (i === 4) throw e;
                        await new Promise(r => setTimeout(r, delay));
                        delay *= 2;
                    }
                }
            };

            const handleStart = async () => {
                if (!data.topic.trim()) return;
                setLoading(true); 
                setLoadingMsg("Menganalisis ide dengan GPT..."); 
                setError(null);
                try {
                    const res = await callOpenAI(
                        data.topic, 
                        "Anda adalah ahli viral marketing. Berikan 3 judul video pendek yang menarik. Format JSON: { \"titles\": [{\"text\": \"Judul\", \"score\": 95}] }"
                    );
                    if (res && res.titles) {
                        setData(p => ({ ...p, titles: res.titles }));
                        setCurrentStep(2);
                    } else {
                        throw new Error("Format respon tidak sesuai");
                    }
                } catch (e) { 
                    setError(`Error: ${e.message}`); 
                } finally { 
                    setLoading(false); 
                }
            };

            const handleTitleSelect = async (t) => {
                setLoading(true); 
                setLoadingMsg("Membuat hook magnetik..."); 
                setData(p => ({ ...p, selectedTitle: t }));
                setError(null);
                try {
                    const res = await callOpenAI(
                        t, 
                        "Buat 2 kalimat pembuka (hook) yang menghentikan scrolling. Format JSON: { \"hooks\": [\"Kalimat 1\", \"Kalimat 2\"] }"
                    );
                    setData(p => ({ ...p, hooks: Array.isArray(res.hooks) ? res.hooks : [] }));
                    setCurrentStep(3);
                } catch (e) { 
                    setError(`Error: ${e.message}`); 
                } finally { 
                    setLoading(false); 
                }
            };

            const handleHookSelect = async (h) => {
                setLoading(true); 
                setLoadingMsg("Menyusun naskah lengkap..."); 
                setData(p => ({ ...p, selectedHook: h }));
                setError(null);
                try {
                    const res = await callOpenAI(
                        `Judul: ${data.selectedTitle}, Hook: ${h}`, 
                        "Tulis naskah video pendek (max 60 detik) dan caption Instagram yang relevan. Format JSON: { \"script\": \"...\", \"caption\": \"...\" }"
                    );
                    setData(p => ({ ...p, script: res.script, caption: res.caption }));
                    setCurrentStep(4);
                } catch (e) { 
                    setError(`Error: ${e.message}`); 
                } finally { 
                    setLoading(false); 
                }
            };

            const handleGoToPrompt = async () => {
                setLoading(true); 
                setLoadingMsg("Menerjemahkan ke prompt visual...");
                setError(null);
                try {
                    const res = await callOpenAI(
                        data.script, 
                        "Buat 3 prompt detail dalam bahasa Inggris untuk generator video AI (Luma/Kling/Runway). Deskripsikan pencahayaan dan gerakan kamera. Format JSON: { \"imagePrompts\": [{\"scene\": \"Nama Scene\", \"prompt\": \"Detailed English Prompt\"}] }"
                    );
                    setData(p => ({ ...p, imagePrompts: Array.isArray(res.imagePrompts) ? res.imagePrompts : [] }));
                    setCurrentStep(5);
                } catch (e) { 
                    setError(`Error: ${e.message}`); 
                } finally { 
                    setLoading(false); 
                }
            };

            const generateVideo = (prompt) => {
                copyToClipboard(prompt);
                speakGuide("Prompt disalin. Membuka Luma Dream Machine.");
                window.open("https://lumalabs.ai/dream-machine", "_blank");
            };

            return (
                <div className="max-w-4xl mx-auto px-6 py-12">
                    <header className="flex justify-between items-center mb-8">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20">
                                <Icon name="zap" className="text-white" size={24}/>
                            </div>
                            <div>
                                <h1 className="text-2xl font-black tracking-tight uppercase italic leading-none">OpenAI <span className="text-blue-500">Native</span></h1>
                                <span className="text-[10px] text-zinc-500 font-bold tracking-[0.2em] uppercase italic">Content Engine v6.7</span>
                            </div>
                        </div>
                        <button onClick={() => setGuideEnabled(!guideEnabled)} className={`flex items-center gap-2 px-4 py-2 rounded-full border transition-all ${guideEnabled ? 'bg-blue-500/10 border-blue-500/50 text-blue-400' : 'bg-white/5 border-white/10 text-zinc-500'}`}>
                            <Icon name={guideEnabled ? "volume-2" : "volume-x"} size={14} className={isSpeaking ? "animate-pulse" : ""} />
                            <span className="text-[10px]
