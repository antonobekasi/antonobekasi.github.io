<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NYETAK Auto Content Generator (ACG)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap');
        
        :root {
            --neon-lime: #a3e635;
            --bg-dark: #0a0a0a;
            --card-bg: #171717;
            --border-color: #262626;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-dark);
            color: #f4f4f5;
            overflow-x: hidden;
        }

        .font-mono { font-family: 'JetBrains Mono', monospace; }

        /* Solid UI Elements */
        .solid-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .card-hover:hover {
            border-color: var(--neon-lime);
            transform: translateY(-2px);
            transition: all 0.2s ease;
        }

        .loader-ring {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            position: relative;
            border: 4px solid #1f1f1f;
            border-top-color: var(--neon-lime);
            animation: spin 1s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .step-content { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Standard scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--neon-lime); }
    </style>
</head>
<body class="selection:bg-[#a3e635] selection:text-black">

    <!-- Global Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 z-[100] bg-black hidden flex-col items-center justify-center text-center">
        <div class="loader-ring mb-6"></div>
        <div class="space-y-2">
            <h2 class="text-xl font-bold uppercase tracking-widest italic" id="loadingTitle">Memproses</h2>
            <p id="loadingMsg" class="text-neutral-500 font-mono text-xs uppercase tracking-[0.2em]">Mengoptimalkan konten untuk Anda...</p>
        </div>
    </div>

    <!-- Header Navigation -->
    <nav class="sticky top-0 z-50 bg-[#0a0a0a] border-b border-[#262626] px-6 py-4">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="bg-[#a3e635] w-9 h-9 rounded-lg flex items-center justify-center shadow-lg">
                    <i class="fas fa-bolt text-black text-sm"></i>
                </div>
                <h1 class="font-extrabold text-lg tracking-tighter uppercase italic">NYETAK <span class="text-[#a3e635]">ACG</span></h1>
            </div>

            <div id="navSteps" class="hidden md:flex items-center gap-1 bg-[#171717] p-1 rounded-xl border border-[#262626]">
                <!-- Steps generated by JS -->
            </div>

            <div class="text-[10px] font-mono text-neutral-600 hidden sm:block uppercase tracking-widest">
                Video Editor Engine
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 py-12">
        
        <!-- STEP 1: BRAINSTORMING -->
        <section id="step1" class="step-content max-w-3xl mx-auto">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-extrabold italic tracking-tighter mb-3">MULAI BUAT <span class="text-[#a3e635]">KONTEN</span></h2>
                <p class="text-neutral-500">Ubah ide mentah menjadi skenario viral yang siap diproduksi.</p>
            </div>

            <div class="solid-card p-8 md:p-10 rounded-3xl space-y-8">
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="space-y-3">
                        <label class="text-[10px] font-bold uppercase tracking-widest text-neutral-500 ml-1">Kategori Niche</label>
                        <select id="niche" class="w-full bg-[#0a0a0a] border border-[#262626] p-4 rounded-xl outline-none focus:border-[#a3e635] text-sm appearance-none">
                            <option value="Film">Film & Animasi</option>
                            <option value="Gaming">Gaming & E-Sports</option>
                            <option value="Edu">Edukasi & Tips</option>
                            <option value="Tech">Sains & Teknologi</option>
                            <option value="Life">Gaya Hidup & Vlog</option>
                        </select>
                    </div>
                    <div class="space-y-3">
                        <label class="text-[10px] font-bold uppercase tracking-widest text-neutral-500 ml-1">Nuansa Konten</label>
                        <select id="tone" class="w-full bg-[#0a0a0a] border border-[#262626] p-4 rounded-xl outline-none focus:border-[#a3e635] text-sm appearance-none">
                            <option value="Story">Storytelling (Bercerita)</option>
                            <option value="Hype">Hype & High-Energy</option>
                            <option value="Deep">Deep & Filosofis</option>
                            <option value="Funny">Kocak & Sarkas</option>
                        </select>
                    </div>
                </div>

                <div class="space-y-3">
                    <label class="text-[10px] font-bold uppercase tracking-widest text-neutral-500 ml-1">Topik Utama</label>
                    <textarea id="topic" class="w-full h-40 bg-[#0a0a0a] border border-[#262626] p-6 rounded-2xl outline-none focus:border-[#a3e635] text-lg font-semibold resize-none placeholder:text-neutral-800" placeholder="Apa yang ingin Anda bahas hari ini?"></textarea>
                </div>

                <button onclick="handleStep1()" class="w-full py-5 bg-[#a3e635] text-black font-extrabold uppercase tracking-widest rounded-2xl hover:bg-[#bef264] transition-all flex items-center justify-center gap-4">
                    <i class="fas fa-wand-magic-sparkles"></i> Brainstorm Ide
                </button>
            </div>
        </section>

        <!-- STEP 2: TITLES -->
        <section id="step2" class="step-content hidden max-w-5xl mx-auto">
            <div class="flex items-end justify-between mb-8">
                <h2 class="text-3xl font-extrabold italic tracking-tighter uppercase">PILIH <span class="text-[#a3e635]">JUDUL</span></h2>
                <button onclick="goToStep(1)" class="px-5 py-2 rounded-lg bg-[#171717] border border-[#262626] text-xs font-bold hover:text-[#a3e635]">Kembali</button>
            </div>
            <div id="titlesList" class="grid gap-4"></div>
        </section>

        <!-- STEP 3: HOOKS -->
        <section id="step3" class="step-content hidden max-w-5xl mx-auto">
            <div class="flex items-end justify-between mb-8">
                <h2 class="text-3xl font-extrabold italic tracking-tighter uppercase">HOOK <span class="text-[#a3e635]">PEMBUKA</span></h2>
                <button onclick="goToStep(2)" class="px-5 py-2 rounded-lg bg-[#171717] border border-[#262626] text-xs font-bold hover:text-[#a3e635]">Kembali</button>
            </div>
            <div id="hooksList" class="grid md:grid-cols-3 gap-6"></div>
        </section>

        <!-- STEP 4: OUTLINE -->
        <section id="step4" class="step-content hidden max-w-6xl mx-auto">
            <div class="grid lg:grid-cols-12 gap-10">
                <div class="lg:col-span-4 space-y-6">
                    <h2 class="text-3xl font-extrabold italic tracking-tighter uppercase">STRUKTUR</h2>
                    <div class="solid-card p-6 rounded-2xl space-y-6">
                        <div class="space-y-2">
                            <label class="text-[10px] font-bold uppercase text-neutral-500">Format Konten</label>
                            <div id="formatButtons" class="space-y-2"></div>
                        </div>
                        <button onclick="handleStep4()" class="w-full py-4 bg-[#a3e635] text-black font-extrabold uppercase text-xs tracking-widest rounded-xl">Generate Naskah</button>
                    </div>
                </div>
                <div class="lg:col-span-8">
                    <textarea id="outlineArea" class="w-full h-[500px] solid-card p-10 rounded-3xl outline-none font-mono text-sm leading-relaxed text-neutral-300 focus:border-[#a3e635] resize-none"></textarea>
                </div>
            </div>
        </section>

        <!-- STEP 5: SCRIPT -->
        <section id="step5" class="step-content hidden max-w-6xl mx-auto">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-extrabold italic tracking-tighter">NASKAH <span class="text-[#a3e635]">LENGKAP</span></h2>
                <div class="flex gap-2">
                    <button onclick="copyToClipboard('scriptArea')" class="px-5 py-2 bg-[#171717] border border-[#262626] rounded-lg text-xs font-bold hover:text-[#a3e635] flex items-center gap-2"><i class="fas fa-copy"></i> Copy</button>
                    <button onclick="goToStep(4)" class="px-5 py-2 bg-[#171717] border border-[#262626] rounded-lg text-xs font-bold"><i class="fas fa-arrow-left"></i></button>
                </div>
            </div>
            <div class="solid-card rounded-3xl overflow-hidden mb-8">
                <textarea id="scriptArea" class="w-full h-[500px] bg-transparent p-10 outline-none font-mono text-sm leading-8 text-neutral-400 resize-none"></textarea>
            </div>
            <button onclick="handleStep5(true)" class="w-full py-5 bg-[#a3e635] text-black font-extrabold uppercase tracking-widest rounded-2xl shadow-xl flex items-center justify-center gap-4">
                <i class="fas fa-image"></i> Buat Konsep Visual Thumbnail
            </button>
        </section>

        <!-- STEP 6: VISUAL -->
        <section id="step6" class="step-content hidden max-w-7xl mx-auto">
            <div class="grid lg:grid-cols-2 gap-10 items-start">
                <div class="space-y-6">
                    <div id="visualContainer" class="solid-card rounded-3xl overflow-hidden min-h-[400px] flex items-center justify-center border-2 border-dashed border-[#262626]">
                        <i class="fas fa-image text-neutral-800 text-5xl"></i>
                    </div>
                    <div class="solid-card p-8 rounded-3xl">
                        <h4 class="text-[10px] font-extrabold text-[#a3e635] uppercase mb-3 tracking-widest">Analisis Visual</h4>
                        <p id="designReasoning" class="text-xs font-mono text-neutral-500 leading-relaxed"></p>
                    </div>
                </div>
                <div class="space-y-8 solid-card p-10 rounded-3xl">
                    <h2 class="text-2xl font-extrabold tracking-tighter italic uppercase">PENGATURAN <span class="text-[#a3e635]">VISUAL</span></h2>
                    <div class="space-y-6">
                        <div class="space-y-2">
                            <label class="text-[10px] font-bold text-neutral-500 uppercase">Teks Utama</label>
                            <input id="mainVisualText" class="w-full bg-[#0a0a0a] border border-[#262626] p-4 rounded-xl outline-none focus:border-[#a3e635]">
                        </div>
                        <div class="space-y-2">
                            <label class="text-[10px] font-bold text-neutral-500 uppercase">Prompt Detail</label>
                            <textarea id="visualPrompt" class="w-full h-32 bg-[#0a0a0a] border border-[#262626] p-4 rounded-xl outline-none focus:border-[#a3e635] text-xs font-mono"></textarea>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="handleStep5(false)" class="py-3 border border-[#262626] rounded-xl font-bold text-[10px] uppercase hover:bg-[#171717]">Render Ulang</button>
                            <button onclick="handleStep6()" class="py-3 bg-[#a3e635] text-black rounded-xl font-extrabold text-[10px] uppercase">Rakit Video Panjang</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- STEP 7: LONG VIDEO PRODUCTION (NEW) -->
        <section id="step7" class="step-content hidden max-w-6xl mx-auto">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-extrabold italic tracking-tighter uppercase">PRODUKSI <span class="text-[#a3e635]">VIDEO PANJANG</span></h2>
                <p class="text-neutral-500">Mengintegrasikan seluruh data menjadi struktur video durasi 5-10 menit.</p>
            </div>
            
            <div class="grid lg:grid-cols-3 gap-8 mb-10">
                <!-- Video Overview Sidebar -->
                <div class="space-y-6">
                    <div class="solid-card p-6 rounded-2xl">
                        <h4 class="text-xs font-bold uppercase text-neutral-500 mb-4 tracking-widest">Detail Produksi</h4>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center py-2 border-b border-[#262626]">
                                <span class="text-[10px] text-neutral-400">Estimasi Durasi</span>
                                <span class="text-xs font-bold text-[#a3e635]" id="videoDuration">~8 Menit</span>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-[#262626]">
                                <span class="text-[10px] text-neutral-400">Total Scene</span>
                                <span class="text-xs font-bold" id="totalScenes">12 Scenes</span>
                            </div>
                            <div class="flex justify-between items-center py-2 border-b border-[#262626]">
                                <span class="text-[10px] text-neutral-400">Tone</span>
                                <span class="text-xs font-bold" id="videoToneDisplay">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="solid-card p-6 rounded-2xl">
                        <h4 class="text-xs font-bold uppercase text-neutral-500 mb-4 tracking-widest">Aset Visual</h4>
                        <div id="visualThumbSmall" class="w-full aspect-video bg-[#0a0a0a] rounded-lg overflow-hidden mb-3"></div>
                        <p class="text-[10px] text-neutral-500 italic">Thumbnail utama yang sudah di-generate.</p>
                    </div>
                </div>

                <!-- Main Video Timeline/Structure -->
                <div class="lg:col-span-2 space-y-6">
                    <div id="videoProjectArea" class="solid-card p-8 rounded-[2.5rem] min-h-[500px]">
                        <div class="flex items-center gap-3 mb-6">
                            <div class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></div>
                            <span class="text-[10px] font-bold uppercase tracking-widest">Sequence Timeline</span>
                        </div>
                        <div id="videoTimelineItems" class="space-y-4">
                            <!-- Items populated by JS -->
                        </div>
                    </div>
                    <div class="flex gap-4">
                         <button onclick="handleStep7()" class="flex-1 py-5 bg-[#a3e635] text-black font-extrabold uppercase tracking-widest rounded-2xl hover:bg-[#bef264] transition-all flex items-center justify-center gap-4">
                            <i class="fas fa-check-double"></i> Finalisasi Distribusi
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- STEP 8: FINAL -->
        <section id="step8" class="step-content hidden max-w-6xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-4xl font-extrabold italic tracking-tighter uppercase">PROYEK <span class="text-[#a3e635]">SIAP PUBLISH</span></h2>
                <p class="text-neutral-500 mt-2">Seluruh aset video panjang dan caption media sosial tersedia.</p>
            </div>
            <div id="distributionList" class="grid md:grid-cols-3 gap-6 mb-10"></div>
            <button onclick="copyFullProject()" class="w-full py-6 bg-[#171717] border border-[#a3e635] text-[#a3e635] font-extrabold text-xl uppercase italic rounded-2xl flex items-center justify-center gap-4">
                <i class="fas fa-file-export"></i> Salin Semua Data (Full Bundle)
            </button>
        </section>

    </main>

    <script>
        const apiKey = "";
        let currentStep = 1;
        let project = { 
            topic: "", 
            titles: [], 
            hooks: [], 
            format: "YouTube Long", 
            selectedTitle: "",
            selectedHook: "",
            niche: "",
            tone: "",
            script: "",
            visual: { b64: null, prompt: "", reasoning: "" }
        };

        const steps = [
            { id: 1, name: "Konsep", icon: "lightbulb" },
            { id: 2, name: "Judul", icon: "heading" },
            { id: 3, name: "Hook", icon: "anchor" },
            { id: 4, name: "Struktur", icon: "layer-group" },
            { id: 5, name: "Naskah", icon: "align-left" },
            { id: 6, name: "Visual", icon: "image" },
            { id: 7, name: "Video", icon: "film" },
            { id: 8, name: "Final", icon: "flag-checkered" }
        ];

        function initApp() {
            renderStepper();
            renderFormatButtons();
        }

        function renderStepper() {
            const container = document.getElementById('navSteps');
            container.innerHTML = steps.map(s => `
                <div class="flex items-center">
                    <button onclick="goToStep(${s.id})" 
                            class="flex items-center gap-2 px-4 py-2 rounded-lg text-[9px] font-bold uppercase transition-all
                                   ${currentStep === s.id ? 'bg-[#a3e635] text-black' : (currentStep > s.id ? 'text-[#a3e635]' : 'text-neutral-600')}"
                            ${currentStep < s.id && !project.topic ? 'disabled' : ''}>
                        <i class="fas fa-${s.icon}"></i> ${s.name}
                    </button>
                    ${s.id !== 8 ? '<div class="w-1 h-1 rounded-full bg-[#262626] mx-1"></div>' : ''}
                </div>
            `).join('');
        }

        function renderFormatButtons() {
            const formats = ["YouTube Long", "Shorts/TikTok", "Instagram Carousel"];
            document.getElementById('formatButtons').innerHTML = formats.map(f => `
                <button onclick="setFormat('${f}')" class="w-full p-4 rounded-xl text-[10px] font-bold uppercase text-left border border-[#262626] transition-all ${project.format === f ? 'bg-[#a3e635] text-black border-[#a3e635]' : 'text-neutral-500 hover:bg-[#171717]'}">${f}</button>
            `).join('');
        }

        function setFormat(f) { project.format = f; renderFormatButtons(); }

        function goToStep(s) {
            if (s > currentStep && !project.topic) return;
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`step${s}`).classList.remove('hidden');
            currentStep = s;
            renderStepper();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleLoading(show, title = "Sedang Memproses", msg = "") {
            const overlay = document.getElementById('loadingOverlay');
            document.getElementById('loadingTitle').innerText = title;
            document.getElementById('loadingMsg').innerText = msg;
            overlay.style.display = show ? 'flex' : 'none';
        }

        async function apiCall(prompt, system, isJson = true) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const body = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: system }] },
                generationConfig: isJson ? { responseMimeType: "application/json" } : {}
            };
            const res = await fetch(url, { method: 'POST', body: JSON.stringify(body) });
            const data = await res.json();
            const text = data.candidates[0].content.parts[0].text;
            return isJson ? JSON.parse(text) : text;
        }

        async function handleStep1() {
            project.topic = document.getElementById('topic').value;
            project.niche = document.getElementById('niche').value;
            project.tone = document.getElementById('tone').value;
            if(!project.topic) return;
            toggleLoading(true, "Brainstorming", "Merumuskan ide konten jangka panjang...");
            try {
                const res = await apiCall(`Topic: ${project.topic}, Niche: ${project.niche}, Tone: ${project.tone}`, "Generate 5 viral headlines. JSON { titles: [{ text, score, reasoning }] }");
                project.titles = res.titles;
                document.getElementById('titlesList').innerHTML = res.titles.map(t => `
                    <button onclick="handleStep2('${t.text.replace(/'/g, "\\'")}')" class="solid-card card-hover p-6 rounded-2xl text-left flex items-center justify-between group transition-all">
                        <div class="space-y-1">
                            <span class="text-[9px] font-bold text-[#a3e635] uppercase">${t.score}% Viral Score</span>
                            <h3 class="text-lg font-bold">${t.text}</h3>
                        </div>
                        <i class="fas fa-chevron-right text-neutral-800 group-hover:text-[#a3e635]"></i>
                    </button>
                `).join('');
                goToStep(2);
            } catch(e) { console.error(e); } finally { toggleLoading(false); }
        }

        async function handleStep2(title) {
            project.selectedTitle = title;
            toggleLoading(true, "Hook Logic", "Mencari pancingan emosi audiens...");
            try {
                const res = await apiCall(`Title: ${title}`, "Create 3 intro hooks for a long video. JSON { hooks: [{ text, psychology }] }");
                project.hooks = res.hooks;
                document.getElementById('hooksList').innerHTML = res.hooks.map(h => `
                    <button onclick="handleStep3('${h.text.replace(/'/g, "\\'")}')" class="solid-card card-hover p-8 rounded-2xl text-left h-full">
                        <p class="font-bold text-sm mb-4 leading-relaxed">"${h.text}"</p>
                        <span class="text-[8px] font-mono text-neutral-600 uppercase">Strategy: ${h.psychology}</span>
                    </button>
                `).join('');
                goToStep(3);
            } catch(e) { console.error(e); } finally { toggleLoading(false); }
        }

        async function handleStep3(hook) {
            project.selectedHook = hook;
            toggleLoading(true, "Outlining", "Membangun arc narasi yang stabil...");
            try {
                const res = await apiCall(`Title: ${project.selectedTitle}, Hook: ${hook}`, "Create long video outline (intro, core pillars, conclusion). JSON { outline: string }");
                document.getElementById('outlineArea').value = res.outline;
                goToStep(4);
            } catch(e) { console.error(e); } finally { toggleLoading(false); }
        }

        async function handleStep4() {
            toggleLoading(true, "Scripting", "Menulis naskah lengkap 1500+ kata...");
            try {
                const res = await apiCall(`Outline: ${document.getElementById('outlineArea').value}`, "Write full production script with B-roll cues and transitions.", false);
                project.script = res;
                document.getElementById('scriptArea').value = res;
                goToStep(5);
            } catch(e) { console.error(e); } finally { toggleLoading(false); }
        }

        async function handleStep5(isNew = true) {
            toggleLoading(true, "Visualizing", "Menciptakan representasi visual...");
            try {
                if(isNew) {
                    const res = await apiCall(`Script: ${document.getElementById('scriptArea').value}`, "Design visual thumbnail for YouTube Long. JSON { mainText, visualPrompt, designReasoning }");
                    document.getElementById('mainVisualText').value = res.mainText;
                    document.getElementById('visualPrompt').value = res.visualPrompt;
                    document.getElementById('designReasoning').innerText = res.designReasoning;
                    project.visual.prompt = res.visualPrompt;
                    project.visual.reasoning = res.designReasoning;
                }
                const imgRes = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                    method: 'POST', body: JSON.stringify({ instances: [{ prompt: document.getElementById('visualPrompt').value }], parameters: { sampleCount: 1, aspectRatio: "16:9" } })
                });
                const imgData = await imgRes.json();
                project.visual.b64 = imgData.predictions[0].bytesBase64Encoded;
                document.getElementById('visualContainer').innerHTML = `<img src="data:image/png;base64,${project.visual.b64}" class="w-full h-full object-cover">`;
                goToStep(6);
            } catch(e) { console.error(e); } finally { toggleLoading(false); }
        }

        async function handleStep6() {
            toggleLoading(true, "Compiling", "Merakit elemen menjadi blueprint video panjang...");
            try {
                const res = await apiCall(`Title: ${project.selectedTitle}, Hook: ${project.selectedHook}, Script: ${project.script}`, "Transform all data into a detailed long video sequence with timestamps. JSON { sequences: [{ time, scene, instruction, audio }], estimatedDuration, totalScenes }");
                
                document.getElementById('videoToneDisplay').innerText = project.tone;
                document.getElementById('videoDuration').innerText = res.estimatedDuration;
                document.getElementById('totalScenes').innerText = res.totalScenes + " Scenes";
                document.getElementById('visualThumbSmall').innerHTML = `<img src="data:image/png;base64,${project.visual.b64}" class="w-full h-full object-cover opacity-50">`;

                document.getElementById('videoTimelineItems').innerHTML = res.sequences.map((s, idx) => `
                    <div class="p-5 bg-[#0a0a0a] border border-[#262626] rounded-xl flex gap-6">
                        <div class="text-[10px] font-mono text-neutral-600 pt-1">${s.time}</div>
                        <div class="space-y-2 flex-1">
                            <h5 class="text-xs font-bold uppercase text-[#a3e635]">${s.scene}</h5>
                            <p class="text-[11px] text-neutral-300 leading-relaxed">${s.audio}</p>
                            <div class="text-[9px] bg-[#171717] p-2 rounded border border-white/5 text-neutral-500 italic">
                                Visual: ${s.instruction}
                            </div>
                        </div>
                    </div>
                `).join('');

                goToStep(7);
            } catch(e) { console.error(e); } finally { toggleLoading(false); }
        }

        async function handleStep7() {
            toggleLoading(true, "Wrapping", "Mempersiapkan materi promosi...");
            try {
                const res = await apiCall(`Title: ${project.selectedTitle}`, "Create captions for YouTube Description, TikTok, and IG Promo. JSON { instagram, tiktok, youtube }");
                const platforms = [{id:'youtube', icon:'youtube'}, {id:'instagram', icon:'instagram'}, {id:'tiktok', icon:'tiktok'}];
                document.getElementById('distributionList').innerHTML = platforms.map(p => `
                    <div class="solid-card p-6 rounded-2xl">
                        <div class="flex items-center gap-2 mb-4 font-bold text-xs uppercase"><i class="fab fa-${p.icon}"></i> ${p.id}</div>
                        <div class="bg-[#0a0a0a] p-4 rounded-lg text-[10px] text-neutral-400 font-mono mb-6 h-32 overflow-y-auto whitespace-pre-wrap">
                            ${res[p.id]}
                        </div>
                        <button onclick="navigator.clipboard.writeText('${res[p.id].replace(/'/g, "\\'")}')" class="w-full py-2 bg-[#262626] rounded-lg text-[9px] font-bold uppercase hover:bg-[#333]">Salin Teks</button>
                    </div>
                `).join('');
                goToStep(8);
            } catch(e) { console.error(e); } finally { toggleLoading(false); }
        }

        function copyToClipboard(id) {
            const el = document.getElementById(id);
            el.select();
            document.execCommand('copy');
        }

        function copyFullProject() {
            const txt = `
JUDUL: ${project.selectedTitle}
HOOK: ${project.selectedHook}
NICHE/TONE: ${project.niche} / ${project.tone}

FULL SCRIPT:
${project.script}

VISUAL PROMPT:
${project.visual.prompt}
            `;
            navigator.clipboard.writeText(txt);
        }

        window.onload = initApp;
    </script>
</body>
</html>
